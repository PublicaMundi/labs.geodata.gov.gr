
# Loopback interface
auto lo
iface lo inet loopback


# Public IPv6 interface
auto {{networking.if.public_ipv6.iface}}
iface {{networking.if.public_ipv6.iface}} inet6 auto
   # Provide IPv6 DNS nameservers - method `auto` does not provide any
   dns-nameservers {{networking.dns.ipv6.nameservers| first}}


{% if networking.if.public_ipv4.iface -%}
# Public IPv4 interface
auto {{networking.if.public_ipv4.iface}}
iface {{networking.if.public_ipv4.iface}} inet dhcp
{%- endif %} 


# Internal IPv4 interface
auto {{networking.if.internal_ipv4.iface}}
iface {{networking.if.internal_ipv4.iface}} inet static
   address {{networking.if.internal_ipv4.address| mandatory}}
   network {{networking.if.internal_ipv4.network| mandatory}}
   netmask {{networking.if.internal_ipv4.netmask| mandatory}}
   {% if not networking.if.public_ipv4.iface -%}
   # Provide a gateway for IPv4 routing
   gateway {{networking.if.internal_ipv4.gateway}}
   # Provide IPv4 DNS nameservers
   dns-nameservers {{networking.dns.ipv4.nameservers[:2]| join(" ")}}
   {% endif -%}

